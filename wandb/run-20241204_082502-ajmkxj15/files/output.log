
 55%|█████████████████████████████████████████████████████████                                               | 22001/40080 [00:00<00:00, 22268.28it/s]

 55%|██████████████████████████████████████████████████████████▏                                               | 22022/40080 [00:15<00:18, 987.46it/s]

 55%|██████████████████████████████████████████████████████████▎                                               | 22041/40080 [00:28<00:50, 355.82it/s][INFO|trainer.py:3614] 2024-12-04 08:25:37,080 >> ***** Running Evaluation *****
[INFO|trainer.py:3616] 2024-12-04 08:25:37,080 >>   Num examples = 408
[INFO|trainer.py:3619] 2024-12-04 08:25:37,080 >>   Batch size = 8





 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████▏        | 47/51 [00:10<00:00,  4.25it/s]

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:11<00:00,  4.25it/s]
Computing accuracy for k=11
Computing accuracy for k=12
Computing accuracy for k=13
Computing accuracy for k=14
  File "my_experiments/tasks/task1/rank_dropout.py", line 1026, in <module>███████████████████████████████████████████| 51/51 [00:11<00:00,  4.25it/s]
    main()
  File "my_experiments/tasks/task1/rank_dropout.py", line 915, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 1859, in train
    return inner_training_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2298, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2662, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3467, in evaluate
    output = eval_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3719, in evaluation_loop
    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds, label_ids=all_labels))
  File "my_experiments/tasks/task1/rank_dropout.py", line 787, in compute_metrics
    accuracy_k_results[f"accuracy_{k}"] = compute_accuracy_for_k(k, model_args.lora_rank)
  File "my_experiments/tasks/task1/rank_dropout.py", line 828, in compute_accuracy_for_k
    correct += (predictions == labels).sum().item()
KeyboardInterrupt