

 55%|█████████████████████████████████████████████████████████▏                                              | 22020/40080 [00:14<00:00, 22846.45it/s]



 55%|██████████████████████████████████████████████████████████▎                                               | 22040/40080 [00:28<00:20, 870.61it/s]

 55%|██████████████████████████████████████████████████████████▎                                               | 22044/40080 [00:30<00:51, 346.99it/s][INFO|trainer.py:3614] 2024-12-04 08:11:58,944 >> ***** Running Evaluation *****
[INFO|trainer.py:3616] 2024-12-04 08:11:58,944 >>   Num examples = 408
[INFO|trainer.py:3619] 2024-12-04 08:11:58,944 >>   Batch size = 8


  File "my_experiments/tasks/task1/rank_dropout.py", line 1027, in <module>                                           | 26/51 [00:05<00:05,  4.25it/s]
    main()
  File "my_experiments/tasks/task1/rank_dropout.py", line 916, in main
    train_result = trainer.train(resume_from_checkpoint="results_mrpc_25/roberta-large/mrpc/pretrained_LoRA_init_svd_rank_25_lr_0.001_clsLR_0.0006_seed_0/last/checkpoint-22000")
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 1859, in train
    return inner_training_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2298, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2662, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3467, in evaluate
    output = eval_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3666, in evaluation_loop
    logits = self.accelerator.pad_across_processes(logits, dim=1, pad_index=-100)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/accelerator.py", line 2294, in pad_across_processes
    return pad_across_processes(tensor, dim=dim, pad_index=pad_index, pad_first=pad_first)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 412, in wrapper
    return function(*args, **kwargs)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 679, in pad_across_processes
    return recursively_apply(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 135, in recursively_apply
    return func(data, *args, **kwargs)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 659, in _pad_across_processes
    size = torch.tensor(tensor.shape, device=tensor.device)[None]
KeyboardInterrupt