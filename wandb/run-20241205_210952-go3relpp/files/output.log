






  0%|                                                                                             | 20/40080 [00:14<7:47:40,  1.43it/s]







  0%|                                                                                             | 39/40080 [00:27<7:56:13,  1.40it/s]







  0%|▏                                                                                            | 59/40080 [00:41<7:54:19,  1.41it/s]







  0%|▏                                                                                            | 79/40080 [00:56<7:59:35,  1.39it/s]







  0%|▏                                                                                            | 98/40080 [01:09<7:59:27,  1.39it/s]







  0%|▎                                                                                           | 118/40080 [01:24<7:53:57,  1.41it/s]







  0%|▎                                                                                           | 137/40080 [01:37<7:55:47,  1.40it/s]








  0%|▎                                                                                           | 159/40080 [01:53<7:55:47,  1.40it/s]







  0%|▍                                                                                           | 179/40080 [02:07<7:57:07,  1.39it/s]







  0%|▍                                                                                           | 199/40080 [02:22<7:54:03,  1.40it/s]







  1%|▌                                                                                           | 218/40080 [02:35<7:55:00,  1.40it/s]







  1%|▌                                                                                           | 238/40080 [02:49<7:51:42,  1.41it/s]







  1%|▌                                                                                           | 258/40080 [03:04<7:52:09,  1.41it/s]







  1%|▋                                                                                           | 277/40080 [03:17<7:50:04,  1.41it/s]







  1%|▋                                                                                           | 297/40080 [03:31<7:50:37,  1.41it/s]







  1%|▋                                                                                           | 317/40080 [03:46<7:54:18,  1.40it/s]





  1%|▊                                                                                           | 334/40080 [03:57<6:42:05,  1.65it/s][INFO|trainer.py:3614] 2024-12-05 21:13:53,670 >> ***** Running Evaluation *****
[INFO|trainer.py:3616] 2024-12-05 21:13:53,671 >>   Num examples = 408
[INFO|trainer.py:3619] 2024-12-05 21:13:53,671 >>   Batch size = 8





 82%|████████████████████████████████████████████████████████████████████████████████▋                 | 42/51 [00:10<00:02,  4.07it/s]



Computing accuracy for k=10: 0.7205882352941176
Computing accuracy for k=11: 0.7205882352941176
Computing accuracy for k=12: 0.7205882352941176
Computing accuracy for k=13: 0.7205882352941176
Computing accuracy for k=14: 0.7205882352941176
Computing accuracy for k=15: 0.7205882352941176
Computing accuracy for k=16: 0.7205882352941176
Computing accuracy for k=17: 0.7205882352941176
Computing accuracy for k=18: 0.7181372549019608
Computing accuracy for k=19: 0.7181372549019608
Computing accuracy for k=20: 0.7181372549019608
Computing accuracy for k=21: 0.7181372549019608
Computing accuracy for k=22: 0.7181372549019608
Computing accuracy for k=23: 0.7156862745098039
Computing accuracy for k=24: 0.7156862745098039
Computing accuracy for k=25: 0.7156862745098039
{'accuracy': 0.7230392156862745, 'f1': 0.8295625942684767, 'combined_score': 0.7763009049773756, 'accuracy_10': 0.7205882352941176, 'accuracy_11': 0.7205882352941176, 'accuracy_12': 0.7205882352941176, 'accuracy_13': 0.7205882352941176, 'accuracy_14': 0.7205882352941176, 'accuracy_15': 0.7205882352941176, 'accuracy_16': 0.7205882352941176, 'accuracy_17': 0.7205882352941176, 'accuracy_18': 0.7181372549019608, 'accuracy_19': 0.7181372549019608, 'accuracy_20': 0.7181372549019608, 'accuracy_21': 0.7181372549019608, 'accuracy_22': 0.7181372549019608, 'accuracy_23': 0.7156862745098039, 'accuracy_24': 0.7156862745098039, 'accuracy_25': 0.7156862745098039}


  1%|▊                                                                                         | 338/40080 [07:28<243:08:56, 22.03s/it]







  1%|▊                                                                                           | 358/40080 [07:42<8:01:51,  1.37it/s]







  1%|▊                                                                                           | 377/40080 [07:55<7:49:40,  1.41it/s]







  1%|▉                                                                                           | 397/40080 [08:09<7:49:13,  1.41it/s]








  1%|▉                                                                                           | 420/40080 [08:26<7:51:37,  1.40it/s]






  1%|█                                                                                           | 437/40080 [08:38<7:49:43,  1.41it/s]








  1%|█                                                                                           | 459/40080 [08:54<7:50:40,  1.40it/s]







  1%|█                                                                                           | 479/40080 [09:08<7:50:14,  1.40it/s]







  1%|█▏                                                                                          | 498/40080 [09:21<7:50:50,  1.40it/s]







  1%|█▏                                                                                          | 518/40080 [09:36<7:48:23,  1.41it/s]







  1%|█▏                                                                                          | 538/40080 [09:50<7:48:18,  1.41it/s]







  1%|█▎                                                                                          | 558/40080 [10:04<7:47:38,  1.41it/s]







  1%|█▎                                                                                          | 577/40080 [10:18<7:47:39,  1.41it/s]








  1%|█▍                                                                                          | 600/40080 [10:34<7:46:22,  1.41it/s]







  2%|█▍                                                                                          | 620/40080 [10:48<7:47:26,  1.41it/s]







  2%|█▍                                                                                          | 639/40080 [11:02<7:46:45,  1.41it/s]







  2%|█▌                                                                                          | 659/40080 [11:16<7:47:04,  1.41it/s]


  2%|█▌                                                                                          | 668/40080 [11:22<6:36:05,  1.66it/s][INFO|trainer.py:3614] 2024-12-05 21:21:18,269 >> ***** Running Evaluation *****
[INFO|trainer.py:3616] 2024-12-05 21:21:18,270 >>   Num examples = 408
[INFO|trainer.py:3619] 2024-12-05 21:21:18,271 >>   Batch size = 8






100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:11<00:00,  4.24it/s]
Computing accuracy for k=10: 0.8382352941176471
Computing accuracy for k=11: 0.8382352941176471
Computing accuracy for k=12: 0.8382352941176471
Computing accuracy for k=13: 0.8382352941176471
Computing accuracy for k=14: 0.8382352941176471
Computing accuracy for k=15: 0.8382352941176471
Computing accuracy for k=16: 0.8382352941176471
Computing accuracy for k=17: 0.8382352941176471
Computing accuracy for k=18: 0.8382352941176471
Computing accuracy for k=19: 0.8382352941176471
Computing accuracy for k=20: 0.8382352941176471
Computing accuracy for k=21: 0.8382352941176471
Computing accuracy for k=22: 0.8382352941176471
Computing accuracy for k=23: 0.8382352941176471
Computing accuracy for k=24: 0.8382352941176471
  File "my_experiments/tasks/task1/rank_dropout.py", line 1120, in <module>████████████████████████████| 51/51 [00:11<00:00,  4.24it/s]
  File "my_experiments/tasks/task1/rank_dropout.py", line 1009, in main
    metrics = train_result.metrics
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 1859, in train
    return inner_training_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2298, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2662, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3467, in evaluate
    output = eval_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3719, in evaluation_loop
    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds, label_ids=all_labels))
  File "my_experiments/tasks/task1/rank_dropout.py", line 882, in compute_metrics
    print(accuracy_k_results[f"accuracy_{k}"])
  File "my_experiments/tasks/task1/rank_dropout.py", line 925, in compute_accuracy_for_k
    total += labels.size(0)
KeyboardInterrupt