

 55%|█████████████████████████████████████████████████████████▏                                              | 22020/40080 [00:14<00:00, 24649.56it/s]


 55%|██████████████████████████████████████████████████████████▎                                               | 22040/40080 [00:28<00:18, 993.05it/s]

 55%|██████████████████████████████████████████████████████████▎                                               | 22042/40080 [00:29<00:52, 344.76it/s][INFO|trainer.py:3614] 2024-12-04 07:39:17,315 >> ***** Running Evaluation *****
[INFO|trainer.py:3616] 2024-12-04 07:39:17,316 >>   Num examples = 408
[INFO|trainer.py:3619] 2024-12-04 07:39:17,316 >>   Batch size = 8





 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████▏        | 47/51 [00:10<00:00,  4.25it/s]

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:11<00:00,  4.25it/s]
Computing accuracy for k=11
Computing accuracy for k=12
Computing accuracy for k=13
Computing accuracy for k=14
Computing accuracy for k=15
Computing accuracy for k=16
Computing accuracy for k=17
Computing accuracy for k=18
Computing accuracy for k=19
Computing accuracy for k=20
Computing accuracy for k=21
Computing accuracy for k=22
Computing accuracy for k=23
Computing accuracy for k=24
Computing accuracy for k=25
{'accuracy': 0.6666666666666666, 'f1': 0.7384615384615384, 'combined_score': 0.7025641025641025, 'accuracy_10': 0.6544117647058824, 'accuracy_11': 0.6617647058823529, 'accuracy_12': 0.678921568627451, 'accuracy_13': 0.6715686274509803, 'accuracy_14': 0.6617647058823529, 'accuracy_15': 0.6593137254901961, 'accuracy_16': 0.6593137254901961, 'accuracy_17': 0.6519607843137255, 'accuracy_18': 0.6544117647058824, 'accuracy_19': 0.6470588235294118, 'accuracy_20': 0.6519607843137255, 'accuracy_21': 0.6495098039215687, 'accuracy_22': 0.6495098039215687, 'accuracy_23': 0.6421568627450981, 'accuracy_24': 0.6446078431372549, 'accuracy_25': 0.6470588235294118}

{'eval_loss': 0.6257687211036682, 'eval_accuracy': 0.6666666666666666, 'eval_f1': 0.7384615384615384, 'eval_combined_score': 0.7025641025641025, 'eval_accuracy_10': 0.6544117647058824, 'eval_accuracy_11': 0.6617647058823529, 'eval_accuracy_12': 0.678921568627451, 'eval_accuracy_13': 0.6715686274509803, 'eval_accuracy_14': 0.6617647058823529, 'eval_accuracy_15': 0.6593137254901961, 'eval_accuracy_16': 0.6593137254901961, 'eval_accuracy_17': 0.6519607843137255, 'eval_accuracy_18': 0.6544117647058824, 'eval_accuracy_19': 0.6470588235294118, 'eval_accuracy_20': 0.6519607843137255, 'eval_accuracy_21': 0.6495098039215687, 'eval_accuracy_22': 0.6495098039215687, 'eval_accuracy_23': 0.6421568627450981, 'eval_accuracy_24': 0.6446078431372549, 'eval_accuracy_25': 0.6470588235294118, 'eval_runtime': 205.5986, 'eval_samples_per_second': 1.984, 'eval_steps_per_second': 0.248, 'epoch': 66.0}


 55%|██████████████████████████████████████████████████████████▉                                                | 22062/40080 [04:09<19:31, 15.38it/s]


 55%|██████████████████████████████████████████████████████████▉                                                | 22084/40080 [04:25<24:17, 12.35it/s]


 55%|███████████████████████████████████████████████████████████                                                | 22104/40080 [04:39<32:32,  9.21it/s]



 55%|███████████████████████████████████████████████████████████                                                | 22125/40080 [04:55<48:12,  6.21it/s]


 55%|██████████████████████████████████████████████████████████                                               | 22145/40080 [05:09<1:12:08,  4.14it/s]



 55%|██████████████████████████████████████████████████████████                                               | 22167/40080 [05:25<1:46:11,  2.81it/s]


 55%|██████████████████████████████████████████████████████████                                               | 22186/40080 [05:39<2:19:13,  2.14it/s]



 55%|██████████████████████████████████████████████████████████▏                                              | 22208/40080 [05:55<2:52:12,  1.73it/s]



 55%|██████████████████████████████████████████████████████████▎                                              | 22235/40080 [06:15<3:20:50,  1.48it/s]





 56%|██████████████████████████████████████████████████████████▎                                              | 22256/40080 [06:30<3:31:45,  1.40it/s]








 56%|██████████████████████████████████████████████████████████▎                                              | 22279/40080 [06:47<3:37:04,  1.37it/s]







 56%|██████████████████████████████████████████████████████████▍                                              | 22298/40080 [07:01<3:37:37,  1.36it/s]







 56%|██████████████████████████████████████████████████████████▍                                              | 22317/40080 [07:15<3:33:55,  1.38it/s]







 56%|██████████████████████████████████████████████████████████▌                                              | 22337/40080 [07:30<3:34:22,  1.38it/s]








 56%|██████████████████████████████████████████████████████████▌                                              | 22359/40080 [07:46<3:35:53,  1.37it/s]






 56%|██████████████████████████████████████████████████████████▋                                              | 22378/40080 [07:59<3:03:03,  1.61it/s][INFO|trainer.py:3614] 2024-12-04 07:46:46,554 >> ***** Running Evaluation *****
[INFO|trainer.py:3616] 2024-12-04 07:46:46,554 >>   Num examples = 408
[INFO|trainer.py:3619] 2024-12-04 07:46:46,554 >>   Batch size = 8
  File "my_experiments/tasks/task1/rank_dropout.py", line 1027, in <module>                                            | 9/51 [00:01<00:10,  4.14it/s]
    main()
  File "my_experiments/tasks/task1/rank_dropout.py", line 916, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 1859, in train
    return inner_training_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2298, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2662, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3467, in evaluate
    output = eval_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3666, in evaluation_loop
    logits = self.accelerator.pad_across_processes(logits, dim=1, pad_index=-100)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/accelerator.py", line 2294, in pad_across_processes
    return pad_across_processes(tensor, dim=dim, pad_index=pad_index, pad_first=pad_first)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 412, in wrapper
    return function(*args, **kwargs)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 679, in pad_across_processes
    return recursively_apply(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 135, in recursively_apply
    return func(data, *args, **kwargs)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 659, in _pad_across_processes
    size = torch.tensor(tensor.shape, device=tensor.device)[None]
KeyboardInterrupt