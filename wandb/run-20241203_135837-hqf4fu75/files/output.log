
MaskingCallback triggered: Selected k = 23
  0%|                                                                                                                       | 0/21420 [00:00<?, ?it/s]Traceback (most recent call last):
  File "my_experiments/tasks/task1/rank_dropout.py", line 937, in <module>
    main()
  File "my_experiments/tasks/task1/rank_dropout.py", line 826, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 1859, in train
    return inner_training_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2200, in _inner_training_loop
    self.control = self.callback_handler.on_step_begin(args, self.state, self.control)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer_callback.py", line 387, in on_step_begin
    return self.call_event("on_step_begin", args, state, control)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer_callback.py", line 415, in call_event
    result = getattr(callback, event)(
  File "/home/mallahova/code/basics/projects/uj/lora_xs/LoRA-XS/my_experiments/tasks/task1/my_utils/custom_trainer.py", line 29, in on_step_begin
    mask = get_mask(rank, k)
  File "/home/mallahova/code/basics/projects/uj/lora_xs/LoRA-XS/my_experiments/tasks/task1/my_utils/custom_trainer.py", line 9, in get_mask
    mask[:k, :k] = 1
IndexError: too many indices for tensor of dimension 1