

 55%|█████████████████████████████████████████████████████████▋                                               | 22019/40080 [00:13<00:15, 1184.56it/s]

 55%|█████████████████████████████████████████████████████████▋                                               | 22020/40080 [00:13<00:16, 1100.85it/s]


 55%|██████████████████████████████████████████████████████████▎                                               | 22040/40080 [00:27<00:50, 358.60it/s][INFO|trainer.py:3614] 2024-12-05 14:44:39,109 >> ***** Running Evaluation *****
[INFO|trainer.py:3616] 2024-12-05 14:44:39,109 >>   Num examples = 408
[INFO|trainer.py:3619] 2024-12-05 14:44:39,110 >>   Batch size = 8



  File "my_experiments/tasks/task1/rank_dropout.py", line 1041, in <module>███                                        | 33/51 [00:07<00:04,  4.27it/s]
    main()
  File "my_experiments/tasks/task1/rank_dropout.py", line 930, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 1859, in train
    return inner_training_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2298, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2662, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3467, in evaluate
    output = eval_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3666, in evaluation_loop
    logits = self.accelerator.pad_across_processes(logits, dim=1, pad_index=-100)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/accelerator.py", line 2294, in pad_across_processes
    return pad_across_processes(tensor, dim=dim, pad_index=pad_index, pad_first=pad_first)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 412, in wrapper
    return function(*args, **kwargs)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 679, in pad_across_processes
    return recursively_apply(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 135, in recursively_apply
    return func(data, *args, **kwargs)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/accelerate/utils/operations.py", line 659, in _pad_across_processes
    size = torch.tensor(tensor.shape, device=tensor.device)[None]
KeyboardInterrupt