


 55%|█████████████████████████████████████████████████████████▋                                               | 22018/40080 [00:12<00:14, 1223.47it/s]


 55%|██████████████████████████████████████████████████████████▎                                               | 22040/40080 [00:27<00:51, 347.67it/s]
 55%|██████████████████████████████████████████████████████████▎                                               | 22040/40080 [00:27<00:51, 347.67it/s][INFO|trainer.py:3614] 2024-12-05 14:48:49,243 >> ***** Running Evaluation *****
[INFO|trainer.py:3616] 2024-12-05 14:48:49,243 >>   Num examples = 408
[INFO|trainer.py:3619] 2024-12-05 14:48:49,243 >>   Batch size = 8





 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌    | 49/51 [00:11<00:00,  4.27it/s]

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:11<00:00,  4.26it/s]
Computing accuracy for k=11
Computing accuracy for k=12
Computing accuracy for k=13
Computing accuracy for k=14
  File "my_experiments/tasks/task1/rank_dropout.py", line 1041, in <module>███████████████████████████████████████████| 51/51 [00:11<00:00,  4.26it/s]
    main()
  File "my_experiments/tasks/task1/rank_dropout.py", line 930, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 1859, in train
    return inner_training_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2298, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 2662, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3467, in evaluate
    output = eval_loop(
  File "/home/mallahova/miniconda3/envs/loraxs/lib/python3.8/site-packages/transformers/trainer.py", line 3719, in evaluation_loop
    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds, label_ids=all_labels))
  File "my_experiments/tasks/task1/rank_dropout.py", line 806, in compute_metrics
    accuracy_k_results[f"accuracy_{k}"] = compute_accuracy_for_k(k, model_args.lora_rank)
  File "my_experiments/tasks/task1/rank_dropout.py", line 847, in compute_accuracy_for_k
    correct += (predictions == labels).sum().item()
KeyboardInterrupt